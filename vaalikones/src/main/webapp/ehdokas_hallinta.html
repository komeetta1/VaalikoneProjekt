<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Ehdokas hallintasivu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="style.css" rel="stylesheet" type="text/css">
</head>
<body>
	<div id="container">
		<img id="headerimg" src="Logo.png" width="720" /> <br>
		
		<form id = "ehdokasLista" onsubmit = "return false;">
		<select id = "selectId" name = "ehdokkaat" size = "23" onchange='testaaSelect(this);'>
				
			</select>
			<p id="demo">asfasdf</p>
		</form>
		
		<script>
		
		function testaaSelect(e){
			window.alert("Valittu ID: "+e.value);
		}
		

		window.onload = function tulostaEhdokkaat(){
				
				var xhttp = new XMLHttpRequest();
				
				xhttp.onreadystatechange = function(){
					if (this.readyState == 4 && this.status == 200){
						
						var palautettu = JSON.parse(this.responseText);
						var z = "";
						for (i=0;i<palautettu.length;i++){
							var y=palautettu[i];
							z = z+"<option value='"+y.ehdokasId+"'>"+y.sukunimi+", "+y.etunimi+"</option>\n";
						}
						
						document.getElementById("selectId").innerHTML = z;
						
					}	
				};
				window.onload
				
				xhttp.open("GET", "./rest/vaalikone/tuoEhdokkaat", true);
				xhttp.send();
				
			}
		</script>
		
		<h4>Ehdokkaiden lisäys</h4>

		<form id="ehdokas_lomake" onsubmit="return false;">
			<input type="text" name="SUKUNIMI" value="" placeholder="Sukunimi"><br>
			<input type="text" name="ETUNIMI" value="" placeholder="Etunimi"><br>
			<input type="text" name="PUOLUE" value="" placeholder="Puolue"><br>
			<input type="text" name="KOTIPAIKKAKUNTA" value="" placeholder="Kotipaikkakunta"><br> 
			<input type="text" name=IKA value="" placeholder="Ika"><br> 
			<input type="text" name="MIKSI_EDUSKUNTAAN" value="" placeholder="Miksi eduskuntaan?"><br>
			<textarea rows="4" cols="50" name="MITA_ASIOITA_HALUAT_EDISTAA" placeholder = "Mita asioita haluat edistaa?"></textarea><br>
			<input type="text" name="AMMATTI" value="" placeholder="Ammatti"><br>
		</form>
		<br>

		<button onclick="laheta();">Lisaa ehdokas</button><br><br><br>
		<div id='tekstikentta'></div>

		<script>
			function laheta() {
				var tiedot = document.getElementById("ehdokas_lomake");

				var ehdokas = new Object();
				ehdokas.sukunimi = tiedot.SUKUNIMI.value;
				ehdokas.etunimi = tiedot.ETUNIMI.value;
				ehdokas.puolue = tiedot.PUOLUE.value;
				ehdokas.kotipaikkakunta = tiedot.KOTIPAIKKAKUNTA.value;
				ehdokas.ika = tiedot.IKA.value;
				ehdokas.miksiEduskuntaan = tiedot.MIKSI_EDUSKUNTAAN.value;
				ehdokas.mitaAsioitaHaluatEdistaa = tiedot.MITA_ASIOITA_HALUAT_EDISTAA.value;
				ehdokas.ammatti = tiedot.AMMATTI.value;

				var jsonehdokas = JSON.stringify(ehdokas);
				document.getElementById("tekstikentta").innerHTML = jsonehdokas;

				var xhttp = new XMLHttpRequest();

				xhttp.open("POST", "./rest/vaalikone/lisaa", true);
				xhttp.setRequestHeader("Content-type", "application/json");
				xhttp.send(jsonehdokas);
			}
		</script>


		<h4>Ehdokkaiden muokkaus</h4>
		<form id="muokkaus_lomake" onsubmit="return false;">
			<input type="text" name="EHDOKAS_ID" value="" placeholder="ID"><br>
			<input type="text" name="SUKUNIMI" value="" placeholder="Sukunimi"><br>
			<input type="text" name="ETUNIMI" value="" placeholder="Etunimi"><br>
			<input type="text" name="PUOLUE" value="" placeholder="Puolue"><br>
			<input type="text" name="KOTIPAIKKAKUNTA" value="" placeholder="Kotipaikkakunta"><br> 
			<input type="text" name=IKA value="" placeholder="Ika"><br> 
			<input type="text" name="MIKSI_EDUSKUNTAAN" value="" placeholder="Miksi eduskuntaan?"><br> 
			<textarea rows="4" cols="50" name="MITA_ASIOITA_HALUAT_EDISTAA" placeholder = "Mita asioita haluat edistaa?"></textarea><br>
			<input type="text" name="AMMATTI" value="" placeholder="Ammatti"><br>

		<br>
		</form>
		<button onclick="muokkaa();">Muokkaa ehdokasta</button><br><br><br>
		<div id='muokattuteksti'></div>
		

		<script>
			function muokkaa() {
				var tiedot = document.getElementById("muokkaus_lomake");

				var ehdokas = new Object();
				ehdokas.ehdokasId = tiedot.EHDOKAS_ID.value;
				ehdokas.sukunimi = tiedot.SUKUNIMI.value;
				ehdokas.etunimi = tiedot.ETUNIMI.value;
				ehdokas.puolue = tiedot.PUOLUE.value;
				ehdokas.kotipaikkakunta = tiedot.KOTIPAIKKAKUNTA.value;
				ehdokas.ika = tiedot.IKA.value;
				ehdokas.miksiEduskuntaan = tiedot.MIKSI_EDUSKUNTAAN.value;
				ehdokas.mitaAsioitaHaluatEdistaa = tiedot.MITA_ASIOITA_HALUAT_EDISTAA.value;
				ehdokas.ammatti = tiedot.AMMATTI.value;

				var jsonehdokas = JSON.stringify(ehdokas);
				document.getElementById("muokattuteksti").innerHTML = jsonehdokas;

				var xhttp = new XMLHttpRequest();

				xhttp.open("POST", "./rest/vaalikone/muokkaa", true);
				xhttp.setRequestHeader("Content-type", "application/json");
				xhttp.send(jsonehdokas);
			}
		</script>


		<h4>Ehdokkaiden poisto</h4>
		<form id="poisto_lomake" onsubmit="return false;">
			<input type="text" name="EHDOKAS_ID" value="" placeholder="ID"><br>
		<br>
		</form>
		<button onclick="poista();">Poista ehdokas</button>
		<div id='poistettuid'></div>
		<script>
			function poista() {
				var tiedot = document.getElementById("poisto_lomake").EHDOKAS_ID.value;
				console.log(tiedot);

				var xhttp = new XMLHttpRequest();
				
				xhttp.onreadystatechange = function(){
					if (this.readyState == 4 && this.status == 200){
						document.getElementById("poistettuid").innerHTML = this.responseText;
						var palautettu=JSON.parse(this.responseText);
					}
				};

				xhttp.open("GET", "./rest/vaalikone/poista/" + tiedot, true);
				xhttp.send();
			}
		</script>

		<br>
		<br>
		<form action="/Admin_sivu.jsp">
			<input type="submit" value="Palaa admin -sivulle" name="btnAdminSivu" />
		</form>
		<form action="index.html" method="POST">
			<input type="submit" value="Palaa etusivulle" name="palaaetusbtn" />
		</form>

	</div>